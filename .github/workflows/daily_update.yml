name: Daily Golf Trend Update â›³

on:
  schedule:
    - cron: '0 21 * * *' # í•œêµ­ ì‹œê°„ ìƒˆë²½ 6ì‹œ
  workflow_dispatch:

jobs:
  update-data:
    runs-on: ubuntu-latest
    
    # ğŸ‘‡ [ê¶Œí•œ ì„¤ì •] ì•„ê¹Œ ì›¹ì—ì„œ ë²„íŠ¼ ëˆŒëŸ¬ì„œ í–ˆë˜ ê±¸ ì½”ë“œë¡œ ë°•ì œí•©ë‹ˆë‹¤ (ì—ëŸ¬ ë°©ì§€)
    permissions:
      contents: write

    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    # ğŸ‘‡ [ì—…ê·¸ë ˆì´ë“œ] íŒŒì´ì¬ 3.9 -> 3.10 (ê²½ê³  í•´ê²°!)
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'

    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt

    # ğŸ‘‡ [ì—¬ê¸°ê°€ í•µì‹¬!] GEMINI í‚¤ë„ ì±™ê¸°ë¼ê³  ì ì–´ì¤˜ì•¼ í•©ë‹ˆë‹¤.
    - name: Run collection script
      env:
        YOUTUBE_API_KEY: ${{ secrets.YOUTUBE_API_KEY }}
        GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
      run: |
        python golf_DB.py

    - name: Commit and push changes
      run: |
        git config --global user.name "GolfBot"
        git config --global user.email "bot@insight-golf.com"
        git add golf.db
        git commit -m "ğŸ¤– Daily Data Update (Auto)" || exit 0
        git push
